(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var o in r)e.o(r,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:r[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.blocks;function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t,o){return(t=function(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,"string");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const l=window.wp.i18n,n=window.wp.serverSideRender;var a=e.n(n);const s=window.wp.blockEditor,i=window.wp.element,c=window.wp.components,u=window.wp.data,d=window.wp.coreData,p=window.wp.hooks,g=window.ReactJSXRuntime,b=(e,t,r)=>{const o=e[t];return e[t]=e[t+r],e[t+r]=o,e},y=({label:e,segments:t,segmentsContent:r,newSegment:o,placeholderText:n,onChange:a})=>(n||(n="Add repeater segments"),(0,g.jsxs)("div",{className:"repeater",children:[e&&(0,g.jsx)("h3",{children:e}),(0,g.jsx)("div",{className:"repeater-segments",children:t&&t.length?r.map((e,r)=>(0,g.jsxs)("div",{className:"repeater-segment",children:[(0,g.jsxs)(c.ButtonGroup,{className:"reorder-segments",children:[(0,g.jsx)(c.Button,{disabled:0===r,className:"reorder-button",icon:(0,g.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",role:"img","aria-hidden":"true",focusable:"false",children:(0,g.jsx)("path",{d:"M12,8l-6,6l1.41,1.41L12,10.83l4.59,4.58L18,14L12,8z"})}),onClick:()=>{const e=b([...t],r,-1);a(e)}}),(0,g.jsx)(c.Button,{disabled:r===t.length-1,className:"reorder-button",icon:(0,g.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",role:"img","aria-hidden":"true",focusable:"false",children:(0,g.jsx)("path",{d:"M7.41,8.59L12,13.17l4.59-4.58L18,10l-6,6l-6-6L7.41,8.59z"})}),onClick:()=>{const e=b([...t],r,1);a(e)}})]}),(0,g.jsx)("div",{className:"segment-content",children:e}),(0,g.jsx)(c.Button,{className:"delete-repeater-segment",isSecondary:!0,isDestructive:!0,icon:(0,g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",children:(0,g.jsx)("rect",{width:"40",height:"3",y:"10"})}),onClick:()=>{const e=[...t];e.splice(r,1),a(e)}})]})):(0,g.jsx)("p",{className:"placeholder-text",children:n})}),o&&(0,g.jsx)(c.Button,{className:"add-repeater-segment",icon:"plus",label:(0,l.__)("Add segment"),onClick:()=>{const e=[...t,Object.assign({id:t.length},o)];a(e)}})]})),m=e=>{const{attributes:t,setAttributes:r}=e,[o,n]=(0,i.useState)(null),a=(0,u.useSelect)(e=>{const r=["postType",t.postType,{per_page:-1,status:"publish",order:"desc",orderby:"date"}];return"manual"===t.contentType?{posts:e(d.store).getEntityRecords(...r),hasStartedResolution:e(d.store).hasStartedResolution("getEntityRecords",r),hasFinishedResolution:e(d.store).hasFinishedResolution("getEntityRecords",r),isResolving:e(d.store).isResolving("getEntityRecords",r)}:{posts:null}},[t.contentType,t.postType]),s=()=>{let e=[];return a.posts?(e.push({value:0,label:(0,l.__)("Select content...")}),a.posts.forEach(r=>{t.manualPosts.some(e=>e.id===r.id)||e.push({value:r.id,label:r.title.raw})})):e.push({value:0,label:(0,l.__)("Loading...")}),e},[p,b]=(0,i.useState)(s());return(0,g.jsxs)(g.Fragment,{children:[a.hasFinishedResolution&&a.posts&&a.posts.length?(0,g.jsx)(c.ComboboxControl,{label:(0,l.__)("Select content"),options:p,value:o,onChange:e=>(e=>{if(e&&0!==e){let o=a.posts.find(t=>t.id==e),l=[...t.manualPosts];l.push({id:o.id,title:o.title.raw}),r({manualPosts:l}),n(null),document.activeElement.blur()}})(e),onFilterValueChange:e=>b(s().filter(t=>t.label.toLowerCase().includes(e.toLowerCase())))}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.Spinner,{})," Loading options..."]}),(0,g.jsx)(y,{segments:t.manualPosts,onChange:e=>r({manualPosts:e}),placeholderText:(0,l.__)("Add content above"),segmentsContent:t.manualPosts.map((e,t)=>(0,g.jsx)("div",{children:e.title}))})]})};function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach(function(t){o(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}const C=e=>{var t;const{attributes:r,setAttributes:o,taxonomies:n}=e,[a,s]=(0,i.useState)(""),p=null===(t=n.results)||void 0===t?void 0:t.map(e=>({label:e.name,value:e.slug})),b=(0,u.useSelect)(e=>{const t=["taxonomy",r.taxonomyQueryType,{per_page:-1}];return{terms:e(d.store).getEntityRecords(...t),hasStartedResolution:e(d.store).hasStartedResolution("getEntityRecords",t),hasFinishedResolution:e(d.store).hasFinishedResolution("getEntityRecords",t),isResolving:e(d.store).isResolving("getEntityRecords",t)}},[r.taxonomyQueryType,r.postType]),y=e=>{const t=document.createElement("textarea");return t.innerHTML=e,t.value},m=(0,i.useMemo)(()=>{if(!b.terms)return[];const e=new Map,t=[];return b.terms.forEach(t=>{e.set(t.id,x(x({},t),{},{name:y(t.name),children:[]}))}),b.terms.forEach(r=>{if(0===r.parent)t.push(e.get(r.id));else{const t=e.get(r.parent);t&&t.children.push(e.get(r.id))}}),t},[b.terms]),h=(0,i.useMemo)(()=>{if(!a.trim())return m;const e=a.toLowerCase(),t=[],r=new Set,o=l=>{l.forEach(l=>{const n=l.name.toLowerCase().includes(e),a=l.children.some(t=>t.name.toLowerCase().includes(e));(n||a)&&(r.has(l.id)||(t.push(l),r.add(l.id)),l.children.forEach(o=>{o.name.toLowerCase().includes(e)&&!r.has(o.id)&&(t.push(o),r.add(o.id))})),l.children.length>0&&o(l.children)})};return o(m),t},[m,a]),C=(e,t=0)=>e.map(e=>(0,g.jsxs)("div",{children:[(0,g.jsx)(c.CheckboxControl,{label:`${"— ".repeat(t)}${e.name}`,checked:r.taxonomyQueryTerms.includes(e.id),onChange:t=>f(t,e.id)}),e.children&&e.children.length>0&&C(e.children,t+1)]},e.id)),f=(e,t)=>{let l=[...r.taxonomyQueryTerms];e?l.push(t):l=l.filter(e=>e!==t),o({taxonomyQueryTerms:l})};return(0,g.jsx)(g.Fragment,{children:n.hasFinishedResolution?(0,g.jsx)(g.Fragment,{children:n.results&&n.results.length?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.SelectControl,{label:(0,l.__)("Taxonomy Type"),value:r.taxonomyQueryType,options:p,onChange:e=>{o({taxonomyQueryTerms:[]}),o({taxonomyQueryType:e})}}),b.hasFinishedResolution?(0,g.jsx)(g.Fragment,{children:b.terms&&b.terms.length?(0,g.jsxs)("div",{className:"taxonomy-term-checklist",children:[(0,g.jsxs)("div",{className:"taxonomy-term-header",children:[(0,g.jsx)("label",{className:"components-base-control__label",children:(0,l.__)(`Select Terms (${r.taxonomyQueryTerms.length})`)}),r.taxonomyQueryTerms.length>0&&(0,g.jsx)("button",{className:"clear-all-button",onClick:()=>o({taxonomyQueryTerms:[]}),children:"Clear All"})]}),r.taxonomyQueryTerms.length>0&&(0,g.jsx)("div",{className:"selected-terms-chips",children:r.taxonomyQueryTerms.map(e=>{var t;const r=null===(t=b.terms)||void 0===t?void 0:t.find(t=>t.id===e);return r?(0,g.jsxs)("button",{onClick:()=>f(!1,e),className:"term-chip",children:[y(r.name),(0,g.jsx)("span",{className:"term-chip-remove",children:"×"})]},e):null})}),(0,g.jsx)(c.TextControl,{placeholder:"Search terms...",value:a,onChange:e=>s(e),className:"term-search-input"}),(0,g.jsx)("div",{className:"term-checklist-wrapper",children:a.trim()?C(h):C(m)})]}):(0,g.jsx)("p",{style:{margin:"-12px 0 24px"},children:"No terms found for this taxonomy."})}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.Spinner,{})," Loading terms..."]})]}):(0,g.jsx)("p",{style:{margin:"-12px 0 24px"},children:"No taxonomies found for this post type."})}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.Spinner,{})," Loading taxonomies..."]})})};function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach(function(t){o(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}const j=(e,t,r,o="customAdditionalContent")=>{const l=[];return Object.entries(e).forEach(([e,n])=>{var a,i;const u=null!==(a=null===(i=t[o])||void 0===i?void 0:i[e])&&void 0!==a?a:n.default;switch(n.type){case"boolean":l.push((0,g.jsx)(c.ToggleControl,{label:n.label||e,checked:u,onChange:l=>{r({[o]:v(v({},t[o]),{},{[e]:l})})}},e));break;case"string":l.push((0,g.jsx)(c.TextControl,{label:n.label||e,value:u,onChange:l=>{r({[o]:v(v({},t[o]),{},{[e]:l})})}},e));break;case"media":l.push((0,g.jsx)(s.MediaUploadCheck,{children:(0,g.jsx)(s.MediaUpload,{label:n.label||e,allowedTypes:["image"],onSelect:t=>{r({[o]:{[e]:{id:t.id,url:t.url}}})},value:u.id,render:({open:t})=>(0,g.jsxs)("div",{className:"image-select",children:[(0,g.jsx)(c.Button,{onClick:t,isLarge:!0,icon:"format-gallery",children:n.label||e}),""!=u.url&&(0,g.jsx)(c.ResponsiveWrapper,{children:(0,g.jsx)("img",{src:u.url})})]})})}));break;case"number":l.push((0,g.jsx)(c.__experimentalNumberControl,{label:n.label||e,value:u,min:n.min||0,max:n.max||100,onChange:l=>{r({[o]:v(v({},t[o]),{},{[e]:Number(l)})})}},e));break;case"select":n.options&&Array.isArray(n.options)&&l.push((0,g.jsx)(c.SelectControl,{label:n.label||e,value:u,options:n.options,onChange:l=>{r({[o]:v(v({},t[o]),{},{[e]:l})})}},e));break;case"textarea":l.push((0,g.jsx)(c.TextareaControl,{label:n.label||e,value:u,onChange:l=>{r({[o]:v(v({},t[o]),{},{[e]:l})})}},e));break;default:console.warn(`Unknown control type: ${n.type} for key: ${e}`)}}),l},T=()=>{const e=KrakenThemeSettings.blockData.cardStyles||{},t=e.add||[],r=e.remove||[];let o=[{label:"Default",value:"default"},{label:"Overlay",value:"overlay"},{label:"Overlay Partial",value:"overlay-partial"},{label:"Text Only",value:"text-only"}];return o=o.filter(e=>!r.includes(e.value)),t.forEach(e=>{o.push(e)}),o};function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach(function(t){o(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}const w=e=>{var t;const{attributes:r,setAttributes:o,taxonomies:n}=e,a=(0,u.useSelect)(e=>{const t=["root","postType",{per_page:-1}];return{results:e(d.store).getEntityRecords(...t),hasStartedResolution:e(d.store).hasStartedResolution("getEntityRecords",t),hasFinishedResolution:e(d.store).hasFinishedResolution("getEntityRecords",t),isResolving:e(d.store).isResolving("getEntityRecords",t)}}),s=(()=>{const e=KrakenThemeSettings.blockData.ignoredPostTypes||{},t=e.add||[],r=e.remove||[];let o=["attachment","nav_menu_item","wp_block","wp_font_family","wp_font_face","wp_global_styles","wp_template","wp_template_part","wp_navigation","rm_content_editor","rank_math_schema"];return o=o.filter(e=>!r.includes(e)),t.forEach(e=>{o.push(e)}),o})(),i=(0,p.applyFilters)("kraken-core.searchAndFilterPostTypeOptions",null===(t=a.results)||void 0===t?void 0:t.sort((e,t)=>e.slug.localeCompare(t.slug)).filter(e=>!s.includes(e.slug)).map(e=>({label:e.labels.name,value:e.slug}))),b=(0,p.applyFilters)("kraken-core.searchAndFilterContentTypes",[{label:"Automatic Recent Posts",value:"automatic"},{label:"Specific Pages/Posts",value:"manual"},{label:"Related Posts (NLP)",value:"related"}]),y=(0,p.applyFilters)("kraken-core.searchAndFilterOrderbyOptions",[{label:r.postType&&r.postType.includes("event")?"Event Date":"Most Recent",value:"date"},{label:"Alphabetical",value:"title"},{label:"Random",value:"rand"},{label:"Manual Posts",value:"post__in"}],r);return(0,g.jsx)(g.Fragment,{children:a.hasFinishedResolution&&a.results&&a.results.length?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(c.PanelBody,{title:"General Settings",children:[(0,g.jsx)(c.SelectControl,{label:(0,l.__)("Content Type"),value:r.contentType,options:b,onChange:e=>{o({contentType:e})}}),(0,g.jsx)(c.SelectControl,{label:(0,l.__)("Post Type"),value:r.postType,options:i,onChange:e=>{o({taxonomyQueryTerms:[]}),o({taxonomyFilters:[]}),o({postType:e}),e.includes("event")&&(o({orderBy:"date"}),o({order:"asc"}))}}),"manual"===r.contentType&&(0,g.jsx)(m,k({},e)),(0,g.jsx)(c.SelectControl,{label:(0,l.__)("View Style"),value:r.enabledView,options:[{label:"Grid",value:"grid"},{label:"List",value:"grid-list"},{label:"Map",value:"map"},{label:"Grid & Map (Toggled)",value:"grid-map"}],onChange:e=>{o({enabledView:e})}})]}),(0,g.jsxs)(c.PanelBody,{title:"Query Settings",initialOpen:!1,children:[(0,g.jsx)(c.__experimentalNumberControl,{label:(0,l.__)("Posts Per Page"),value:r.perPage,min:1,onChange:e=>{o({perPage:Number(e)})}}),(0,g.jsx)(c.__experimentalNumberControl,{label:(0,l.__)("Posts Per Page (Mobile)"),value:r.perPageMobile,min:1,onChange:e=>{o({perPageMobile:Number(e)})}}),(0,g.jsx)(c.SelectControl,{label:(0,l.__)("Order By"),value:r.orderBy,options:y,onChange:e=>{o({orderBy:e})}}),(0,g.jsx)(c.SelectControl,{label:(0,l.__)("Order ASC/DESC"),value:r.order,options:[{label:"Ascending",value:"asc"},{label:"Descending",value:"desc"}],onChange:e=>{o({order:e})}}),"rand"===r.orderBy&&(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Cache Random Posts"),help:(0,l.__)("Cache random posts for a day per user"),checked:r.cachePosts,onChange:()=>{o({cachePosts:!r.cachePosts})}}),(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Enable Taxonomy Query"),help:(0,l.__)("Limit the results by taxonomy terms"),checked:r.enableTaxonomyQuery,onChange:()=>{o({enableTaxonomyQuery:!r.enableTaxonomyQuery})}}),r.enableTaxonomyQuery&&(0,g.jsx)(C,k({},e)),r.postType&&r.postType.includes("event")&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Enable Date Query"),help:(0,l.__)("Limit the results by date"),checked:r.enableDateQuery,onChange:()=>{o({enableDateQuery:!r.enableDateQuery})}}),r.enableDateQuery&&(0,g.jsx)(c.__experimentalNumberControl,{label:(0,l.__)("Days to Display"),help:(0,l.__)("Set how many days of events to load by default. The start date will always be set to the current date."),value:r.selectedDateRange,min:1,onChange:e=>{o({selectedDateRange:Number(e)})}})]})]})]}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.Spinner,{})," Loading post types..."]})})},{useSelect:O}=wp.data,S=e=>{const{attributes:t,setAttributes:r}=e,o=O(t=>t("core/block-editor").getBlockName(e.clientId));return(0,g.jsxs)(g.Fragment,{children:["queried_post"!==t.postType&&"kraken-core/content-card"===o&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Custom Title"),checked:t.displayCustomTitle,onChange:()=>{r({displayCustomTitle:!t.displayCustomTitle})}}),t.displayCustomTitle&&(0,g.jsx)(c.TextareaControl,{label:(0,l.__)("Customize Title Text"),value:t.customTitle,onChange:e=>{r({customTitle:e})}}),(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Custom Image"),checked:t.displayCustomImage,onChange:()=>{r({displayCustomImage:!t.displayCustomImage})}}),t.displayCustomImage&&(0,g.jsx)(s.MediaUploadCheck,{children:(0,g.jsx)(s.MediaUpload,{title:(0,l.__)("Upload Image"),allowedTypes:["image"],onSelect:e=>{r({customImage:{id:e.id,url:e.url}})},value:t.customImage.id,render:({open:e})=>(0,g.jsxs)("div",{className:"image-select",children:[(0,g.jsx)(c.Button,{onClick:e,isLarge:!0,icon:"format-gallery",children:(0,l.__)("Select Image")}),""!=t.customImage.url&&(0,g.jsx)(c.ResponsiveWrapper,{children:(0,g.jsx)("img",{src:t.customImage.url})})]})})})]}),(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Display Additional Content?"),checked:t.displayAdditionalContent,onChange:()=>{r({displayAdditionalContent:!t.displayAdditionalContent})}}),t.displayAdditionalContent&&(0,g.jsxs)(g.Fragment,{children:[t.postType.includes("event")&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Event Date"),checked:t.displayEventDate,onChange:()=>{r({displayEventDate:!t.displayEventDate})}}),(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Event Time"),checked:t.displayEventTime,onChange:()=>{r({displayEventTime:!t.displayEventTime})}})]}),(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Address"),checked:t.displayAddress,onChange:()=>{r({displayAddress:!t.displayAddress})}}),(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Website Link"),checked:t.displayWebsiteLink,onChange:()=>{r({displayWebsiteLink:!t.displayWebsiteLink})}}),(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Post Excerpt"),checked:t.displayExcerpt,onChange:()=>{r({displayExcerpt:!t.displayExcerpt,displayCustomExcerpt:!1})}}),t.displayExcerpt&&(0,g.jsx)(c.__experimentalNumberControl,{label:(0,l.__)("Excerpt Word Count"),value:t.excerptLength,min:0,onChange:e=>{r({excerptLength:Number(e)})}}),"queried_post"!==t.postType&&"kraken-core/content-card"===o&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Custom Excerpt"),checked:t.displayCustomExcerpt,onChange:()=>{r({displayExcerpt:!1,displayCustomExcerpt:!t.displayCustomExcerpt})}}),t.displayCustomExcerpt&&(0,g.jsx)(c.TextareaControl,{label:(0,l.__)("Customize Excerpt Text"),value:t.customExcerpt,onChange:e=>{r({customExcerpt:e})}})]}),(0,g.jsx)("hr",{}),(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Read More Text"),checked:t.displayReadMore,onChange:()=>{r({displayReadMore:!t.displayReadMore})}}),t.displayReadMore&&(0,g.jsx)(c.TextControl,{label:(0,l.__)("Customize Read More Text"),value:t.readMoreText,onChange:e=>{r({readMoreText:e})}}),(0,g.jsx)("hr",{}),(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Display Mindtrip CTA"),help:(0,l.__)("Requires Mindtrip integration"),checked:t.displayMindtripCta,onChange:()=>{r({displayMindtripCta:!t.displayMindtripCta})}}),t.displayMindtripCta&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.SelectControl,{label:(0,l.__)("Mindtrip CTA Type"),value:t.mindtripCtaType,options:[{label:"Button",value:"button"},{label:"Icon Only",value:"icon-only"}],onChange:e=>{r({mindtripCtaType:e})}}),(0,g.jsx)(c.TextControl,{label:(0,l.__)("Mindtrip CTA Text"),help:(0,l.__)("Sparkle added automatically"),value:t.mindtripCtaText,onChange:e=>{r({mindtripCtaText:e})}}),(0,g.jsx)(c.TextControl,{label:(0,l.__)("Mindtrip Prompt"),help:(0,l.__)("Use %postname% to output the post/listing name in your prompt. Defaults to `Explore things to do near %postname%`"),value:t.mindtripPrompt,onChange:e=>{r({mindtripPrompt:e})}})]}),(()=>{const e=KrakenThemeSettings.blockData.cardAttributes;return Object.keys(e).length>0&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("hr",{}),j(e,t,r,"customAdditionalContent")]})})()]})]})};function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach(function(t){o(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}const E=e=>{const{attributes:r,setAttributes:o}=e;return(0,g.jsx)(g.Fragment,{children:(0,t.getBlockType)("kraken-core/content-card")&&(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)(c.PanelBody,{title:"Card Settings",initialOpen:!1,children:[(0,g.jsx)(c.SelectControl,{label:(0,l.__)("Card Style"),value:r.cardStyle,options:T(),onChange:e=>{o({cardStyle:e})}}),(0,g.jsx)(S,P({},e))]})})})},A=e=>{var t;const{attributes:r,setAttributes:o,taxonomies:n}=e,a=null===(t=n.results)||void 0===t?void 0:t.map(e=>({label:e.name,value:e.slug}));return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Enable Filter Bar"),help:(0,l.__)("Allows users to filter & sort the results"),checked:r.enableFilterBar,onChange:()=>{o({enableFilterBar:!r.enableFilterBar})}}),r.enableFilterBar&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Display as Sidebar"),checked:r.displayFilterSidebar,onChange:()=>{o({displayFilterSidebar:!r.displayFilterSidebar})}}),(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Enable Search Input"),checked:r.enableSearchInput,onChange:()=>{o({enableSearchInput:!r.enableSearchInput})}}),r.postType&&r.postType.includes("event")&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Enable Start Date Filter"),checked:r.enableStartDateFilter,onChange:()=>{o({enableStartDateFilter:!r.enableStartDateFilter})}}),(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Enable End Date Filter"),checked:r.enableEndDateFilter,onChange:()=>{o({enableEndDateFilter:!r.enableEndDateFilter})}})]}),(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Enable Taxonomy Filters"),checked:r.enableTaxonomyFilter,onChange:()=>{o({enableTaxonomyFilter:!r.enableTaxonomyFilter})}}),r.enableTaxonomyFilter&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.SelectControl,{label:(0,l.__)(`Select Taxonomy Filters (${r.taxonomyFilters.length})`),options:a,value:r.taxonomyFilters,multiple:!0,onChange:e=>(e=>{let t=n.results.find(t=>t.slug==e),l=[...r.taxonomyFilters];l.includes(t.slug)?l=l.filter(e=>e!==t.slug):l.push(t.slug),o({taxonomyFilters:l})})(e)}),(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Require All Terms"),checked:r.requireAllTerms,onChange:()=>{o({requireAllTerms:!r.requireAllTerms})}})]}),(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Enable Sorting"),checked:r.enableSortingFilter,onChange:()=>{o({enableSortingFilter:!r.enableSortingFilter})}}),(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Enable Active Filter Count"),checked:r.enableActiveFilterCount,onChange:()=>{o({enableActiveFilterCount:!r.enableActiveFilterCount})}}),(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Enable Active Filter Display"),checked:r.enableActiveFilterDisplay,onChange:()=>{o({enableActiveFilterDisplay:!r.enableActiveFilterDisplay})}}),(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Enable Clear All Button"),checked:r.enableClearAllButton,onChange:()=>{o({enableClearAllButton:!r.enableClearAllButton})}})]})]})},B=e=>{const{attributes:t,setAttributes:r}=e;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.SelectControl,{label:(0,l.__)("Pagination Style"),value:t.paginationStyle,options:[{label:"Load more button",value:"load-more"},{label:"Page numbers",value:"page-numbers"},{label:"None",value:"none"}],onChange:e=>{r({paginationStyle:e})}}),(0,g.jsx)(c.ToggleControl,{label:(0,l.__)("Display Results Count"),checked:t.displayResultsCount,onChange:()=>{r({displayResultsCount:!t.displayResultsCount})}})]})},R={general:[{attribute:"backgroundColor",label:"Card Background"},{attribute:"textColor",label:"Card Text"},{attribute:"spinnerColor",label:"Loading Spinner"},{attribute:"resultsCountTextColor",label:"Results Count Text"},{attribute:"noResultsTextColor",label:"No Results Text"}],filters:[{attribute:"filterBarBackgroundColor",label:"Bar Background"},{attribute:"filterBarTextColor",label:"Bar Text"},{attribute:"filterBackgroundColor",label:"Background"},{attribute:"filterTextColor",label:"Text"},{attribute:"filterBackgroundHoverColor",label:"Background Hover"},{attribute:"filterTextHoverColor",label:"Text Hover"},{attribute:"activeFilterBackgroundColor",label:"Active Background"},{attribute:"activeFilterTextColor",label:"Active Text"},{attribute:"activeFilterBackgroundHoverColor",label:"Active Background Hover"},{attribute:"activeFilterTextHoverColor",label:"Active Text Hover"},{attribute:"resetFilterBackgroundColor",label:"Reset Background"},{attribute:"resetFilterTextColor",label:"Reset Text"},{attribute:"resetFilterBackgroundHoverColor",label:"Reset Background Hover"},{attribute:"resetFilterTextHoverColor",label:"Reset Text Hover"}],events:[{attribute:"eventDateBackgroundColor",label:"Event Date Background"},{attribute:"eventDateTextColor",label:"Event Date Text"}],pagination:[{attribute:"paginationBackgroundColor",label:"Background"},{attribute:"paginationBackgroundHoverColor",label:"Background Hover"},{attribute:"paginationBackgroundActiveColor",label:"Background Active"},{attribute:"paginationTextColor",label:"Text"},{attribute:"paginationTextHoverColor",label:" Text Hover"},{attribute:"paginationTextActiveColor",label:"Text Active"},{attribute:"paginationArrowBackgroundColor",label:"Arrow Background"},{attribute:"paginationArrowBackgroundHoverColor",label:"Arrow Background Hover"},{attribute:"paginationArrowColor",label:"Arrow"},{attribute:"paginationArrowHoverColor",label:"Arrow Hover"}],toggles:[{attribute:"viewToggleBackgroundColor",label:"Background"},{attribute:"viewToggleBackgroundHoverColor",label:"Background Hover"},{attribute:"viewToggleTextColor",label:"Text"},{attribute:"viewToggleTextHoverColor",label:"Text Hover"}]},D=({title:e,colors:t,props:r})=>{const o=t.map(({attribute:e,label:t})=>{const o=`set${e.charAt(0).toUpperCase()+e.slice(1)}`;return{value:r[e].color,onChange:r[o],label:(0,l.__)(t,"kraken-core")}}),n=t.some(({attribute:e})=>{var t;return void 0!==(null===(t=r[e])||void 0===t?void 0:t.color)});return(0,g.jsxs)(c.PanelBody,{title:(0,l.__)(e,"kraken-core"),initialOpen:!1,children:[(0,g.jsx)(s.PanelColorSettings,{colorSettings:o,className:"kraken-core-color-panel"}),n&&(0,g.jsx)("div",{style:{marginTop:"0.75rem"},children:(0,g.jsx)(c.Button,{variant:"secondary",isSmall:!0,onClick:()=>{t.forEach(({attribute:e})=>{const t=`set${e.charAt(0).toUpperCase()+e.slice(1)}`,o=r[t];o&&o(void 0)})},children:(0,l.__)("Reset Colors","kraken-core")})})]})},N=Object.values(R).flat().reduce((e,{attribute:t})=>(e[t]=t.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g,"$1-$2").toLowerCase(),e),{}),M=(0,s.withColors)(N)(e=>(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(D,{title:"General Colors",colors:R.general,props:e}),(0,g.jsx)(D,{title:"Filter Colors",colors:R.filters,props:e}),"event"===e.attributes.postType&&(0,g.jsx)(D,{title:"Event Colors",colors:R.events,props:e}),(0,g.jsx)(D,{title:"Pagination Colors",colors:R.pagination,props:e}),(0,g.jsx)(D,{title:"View Toggle Colors",colors:R.toggles,props:e})]}));function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach(function(t){o(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}const Q=e=>{const{attributes:t,setAttributes:r}=e,o=(0,s.useBlockProps)(),l=(0,u.useSelect)(e=>{const r=["root","taxonomy",{type:t.postType,per_page:-1}];return{results:e(d.store).getEntityRecords(...r),hasStartedResolution:e(d.store).hasStartedResolution("getEntityRecords",r),hasFinishedResolution:e(d.store).hasFinishedResolution("getEntityRecords",r),isResolving:e(d.store).isResolving("getEntityRecords",r)}},[t.postType]);return(0,i.useEffect)(()=>{l.results&&l.results.length&&(l.results.sort((e,t)=>e.slug.localeCompare(t.slug)),l.results.some(e=>e.slug===t.taxonomyQueryType)||r({taxonomyQueryType:l.results[0].slug}))},[l]),(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(s.InspectorControls,{group:"settings",children:(0,g.jsxs)("div",{className:o.className,children:[(0,g.jsx)(w,L(L({},e),{},{taxonomies:l})),(0,g.jsx)(E,L({},e)),(0,g.jsx)(c.PanelBody,{title:"Filter Bar Settings",initialOpen:!1,children:(0,g.jsx)(A,L(L({},e),{},{taxonomies:l}))}),(0,g.jsx)(c.PanelBody,{title:"Pagination Settings",initialOpen:!1,children:(0,g.jsx)(B,L({},e))})]})}),(0,g.jsx)(s.InspectorControls,{group:"styles",children:(0,g.jsx)(M,L({},e))})]})};function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}const $=e=>(0,g.jsx)(Q,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach(function(t){o(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e));function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach(function(t){o(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}const W=e=>{const t=(0,s.useBlockProps)();return(0,g.jsx)("div",q(q({},t),{},{children:(0,g.jsx)(a(),q({block:e.name},e))}))},V=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"version":"1.1.1","name":"kraken-core/search-and-filter","title":"[Kraken] Search & Filter","description":"Search engine for all post types & taxonomies","icon":"embed-photo","category":"kraken-core","attributes":{"contentType":{"type":"string","default":"automatic"},"postType":{"type":"string","default":"post"},"enableDateQuery":{"type":"boolean","default":false},"selectedDateRange":{"type":"number","default":0},"enableTaxonomyQuery":{"type":"boolean","default":false},"taxonomyQueryType":{"type":"string","default":"category"},"taxonomyQueryTerms":{"type":"array","default":[]},"manualPosts":{"type":"array","default":[],"items":{"type":"object"}},"perPage":{"type":"number","default":6},"perPageMobile":{"type":"number","default":3},"orderBy":{"type":"string","default":"date"},"order":{"type":"string","default":"desc"},"cachePosts":{"type":"boolean","default":false},"enableFilterBar":{"type":"boolean","default":false},"displayFilterSidebar":{"type":"boolean","default":true},"enableSearchInput":{"type":"boolean","default":false},"enableStartDateFilter":{"type":"boolean","default":false},"enableEndDateFilter":{"type":"boolean","default":false},"enableTaxonomyFilter":{"type":"boolean","default":false},"taxonomyFilters":{"type":"array","default":[]},"requireAllTerms":{"type":"boolean","default":false},"enableSortingFilter":{"type":"boolean","default":false},"enableActiveFilterCount":{"type":"boolean","default":false},"enableActiveFilterDisplay":{"type":"boolean","default":false},"enableClearAllButton":{"type":"boolean","default":true},"enabledView":{"type":"string","default":"grid"},"paginationStyle":{"type":"string","default":"page-numbers"},"displayResultsCount":{"type":"boolean","default":true},"cardStyle":{"type":"string","default":"default"},"displayAdditionalContent":{"type":"boolean","default":false},"displayEventDate":{"type":"boolean","default":false},"displayEventTime":{"type":"boolean","default":false},"displayAddress":{"type":"boolean","default":false},"displayWebsiteLink":{"type":"boolean","default":false},"displayMindtripCta":{"type":"boolean","default":false},"mindtripCtaType":{"type":"string","default":"button"},"mindtripCtaText":{"type":"string","default":""},"mindtripPrompt":{"type":"string","default":""},"displayExcerpt":{"type":"boolean","default":false},"excerptLength":{"type":"number","default":12},"displayReadMore":{"type":"boolean","default":false},"readMoreText":{"type":"string","default":"Read More"},"backgroundColor":{"type":"string","default":""},"textColor":{"type":"string","default":""},"filterBarBackgroundColor":{"type":"string","default":""},"filterBarTextColor":{"type":"string","default":""},"filterBackgroundColor":{"type":"string","default":""},"filterBackgroundHoverColor":{"type":"string","default":""},"filterTextColor":{"type":"string","default":""},"filterTextHoverColor":{"type":"string","default":""},"activeFilterBackgroundColor":{"type":"string","default":""},"activeFilterTextColor":{"type":"string","default":""},"activeFilterBackgroundHoverColor":{"type":"string","default":""},"activeFilterTextHoverColor":{"type":"string","default":""},"resetFilterBackgroundColor":{"type":"string","default":""},"resetFilterTextColor":{"type":"string","default":""},"resetFilterBackgroundHoverColor":{"type":"string","default":""},"resetFilterTextHoverColor":{"type":"string","default":""},"paginationBackgroundColor":{"type":"string","default":""},"paginationTextColor":{"type":"string","default":""},"paginationBackgroundHoverColor":{"type":"string","default":""},"paginationTextHoverColor":{"type":"string","default":""},"paginationBackgroundActiveColor":{"type":"string","default":""},"paginationTextActiveColor":{"type":"string","default":""},"paginationArrowBackgroundColor":{"type":"string","default":""},"paginationArrowColor":{"type":"string","default":""},"paginationArrowBackgroundHoverColor":{"type":"string","default":""},"paginationArrowHoverColor":{"type":"string","default":""},"viewToggleBackgroundColor":{"type":"string","default":""},"viewToggleTextColor":{"type":"string","default":""},"viewToggleBackgroundHoverColor":{"type":"string","default":""},"viewToggleTextHoverColor":{"type":"string","default":""},"spinnerColor":{"type":"string","default":""},"resultsCountTextColor":{"type":"string","default":""},"noResultsTextColor":{"type":"string","default":""},"eventDateBackgroundColor":{"type":"string","default":""},"eventDateTextColor":{"type":"string","default":""},"customAdditionalContent":{"type":"object","default":{}}},"supports":{"align":true},"editorScript":"file:./index.js","editorStyle":"file:./index.css","viewScript":"file:./assets/search-and-filter.js","style":"file:./assets/style-search-and-filter.css","render":"file:./render.php"}');(0,t.registerBlockType)(V,{edit:e=>{const{attributes:t,setAttributes:r}=e;return(0,i.useEffect)(()=>{var e;const o=(null===(e=KrakenThemeSettings)||void 0===e||null===(e=e.blockData)||void 0===e?void 0:e.cardAttributes)||{};if(t.customAdditionalContent&&Object.keys(t.customAdditionalContent).length>0){const e=((e,t)=>{const r=t.customAdditionalContent||{},o=Object.keys(e),l={};return o.forEach(e=>{r.hasOwnProperty(e)&&(l[e]=r[e])}),l})(o,t);Object.keys(e).length!==Object.keys(t.customAdditionalContent).length&&r({customAdditionalContent:e})}},[]),(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)($,q({},e)),(0,g.jsx)(W,q({},e))]})},save:()=>(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(s.InnerBlocks.Content,{})})})})();